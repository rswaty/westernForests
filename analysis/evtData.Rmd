---
title: "evtData"
author: "Kori Blankenship and Randy Swaty"
date: "2022-03-01"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

```{r packages, message=FALSE, warning=FALSE, include=FALSE}
library(DT)
library(scales)
library(tidyverse)
```


## The EVT data

Below is a chart representing acres per LANDFIRE EVT (Ecological System; from NatureServe), followed by the raw data.  

**Notable:**
 * There are 112 types total.  No oddballs noted.
 * We assume we will filter out "wet" types, types that do not exist in the western US as we know it, and pinyon-juniper-cedar types.
 * 80% of the area is covered by 27 EVTs in this unfiltered data.  


### The (long!) chart

```{r tmChart, echo=FALSE, message=FALSE, warning=FALSE, fig.height=18, fig.width=10, fig.align='left'}

# read in data
fsttype_evt200 <- read_csv("data/fsttype_evt200.csv")
#View(fsttype_evt200)

# format TreeMap data for chart
evtData <- fsttype_evt200 %>%
  group_by(EVT_NAME) %>%
  summarise(COUNT = sum(COUNT)) %>%
  mutate(ACRES = (COUNT *0.222)) %>%
  arrange(desc(ACRES))

# make chart
evtPlot <-
  ggplot(evtData, aes(y = ACRES, x = reorder(EVT_NAME, -ACRES))) +
  geom_bar(stat = "identity", fill = "#784e7a") +
  coord_flip() +
  labs(
    title = "Acreage of each forested LANDFIRE EVT in the western states",
    subtitle = "Unfiltered, i.e., includes Pinyon-Junper and riparian types",
    caption = "Data from https://landfire.gov/evt.php",
    x = "",
    y = "Acres",
    fill = "Status") +
  scale_x_discrete(limits=rev) +
	scale_y_continuous(labels = label_number(suffix = " M", scale = 1e-6)) + 
  theme_bw(base_size = 14) + 
  theme(plot.caption = element_text(hjust = 0, face= "italic"), #Default is hjust=1
        plot.title.position = "plot", #NEW parameter. Apply for subtitle too.
        plot.caption.position =  "plot")  +
  annotate(
    geom = "curve", x = 86, y = 10000000, xend = 89, yend = 3000000,
    curvature = .3, arrow = arrow(length = unit(2, "mm"))
  ) +
  annotate(geom = "text", x = 86, y = 10000000, label = "80% point", hjust = "left")

evtPlot

```
 
 <br>
 
### Data table


Here's the data as used in the chart above for your amusememt.
<br>

```{r tmData, echo=FALSE, message=FALSE, warning=FALSE}


datatable(evtData,
          colnames = c("EVTs",
                       "Raw pixel count",
                       "Acres"),
          class = 'cell-border stripe')

```




